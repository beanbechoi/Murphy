// Murphy's Revenge// (c)1997 Q Software / Dave Peck, All Rights Reserved// This source code is confidential and proprietary, and may not be reproduced// or utilized by anyone without the express written permission of Q Software.// File: MRError.c// Auth: Dave Peck// Date: 6/10/97// Desc: error handling code for Murphy's Revenge// ----------------------------------------------------------------// Includes// ----------------------------------------------------------------#include "MRError.h"#include "MRInit.h"#include "MRFade.h"#include "MacIncludes.h"// ----------------------------------------------------------------// Constants// ----------------------------------------------------------------// ----------------------------------------------------------------// Data Structures// ----------------------------------------------------------------// ----------------------------------------------------------------// Function Prototypes// ----------------------------------------------------------------// ----------------------------------------------------------------// Functions// ----------------------------------------------------------------// Execute a fatal error.void FatalMRError( char* description ) {	// Fade back in for error status.	FadeInImmediate();		// Set the output.	ParamText( C2PStr(description), "\p-1", "\p", "\p" );	// Beep. I know alerts do this automatically, but this is easier.	SysBeep(5);		// Run the alert.	(void) StopAlert( kFatalErrAlrtID, NULL );		// Call MR Cleanup routines here!!	CleanUpForExit();		// Exit To Shell. Deep, no?	ExitToShell();}// And a startup error.void StartupError( char* description ) {	// Fade in for the error.	FadeInImmediate();		// Set the output.	ParamText( C2PStr(description), "\p-1", "\p", "\p" );	// For the startling effect...	SysBeep(5);		// Run the alert.	(void) StopAlert( kStartupErrAlrtID, NULL );		// Call MR Cleanup routines here!!	CleanUpForExit();		// Exit To Shell. Deep, no?	ExitToShell();}// Call errorcheck with an OSErr.// Returns false on an error; if the error is fatal, it will quit instead.Boolean ErrorCheck( OSErr theError, char* description, Boolean fatal ) {	if ( theError == noErr )		return true;		if ( fatal )		FatalMRError( description );	else {		Boolean		isFaded = ScreenIsFaded();				if ( isFaded )			FadeInImmediate();				// Beep for effect.		SysBeep(5);				ParamText( C2PStr(description), "\p-1", "\p", "\p" );				(void)NoteAlert( kStartupErrAlrtID, NULL );				if ( isFaded )			FadeOutImmediate();		}		return false;}