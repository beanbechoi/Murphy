unit CZonk;interface	uses		TCL, GridPieceIntf;implementation	function CZonk.Push (x, y: integer): boolean;		var			murGT, murCF: integer;			whereTo: point;			iAm: integer;			myChore: CMoveChore;			whatAt: integer;			pushedTo: point;			whatBelow: integer;	begin		murGT := CInfoApp(gApplication).GetMurphy.GetLastDir;		murCF := 8 - murGT;		whereTo := CInfoApp(gApplication).LocFromDir(x, y, murGT);		whatAt := CInfoApp(gApplication).GetGPane.GetBoard.GetData(whereTo.h, whereTo.v);{whatBelow := CINfoapp(gapplication).GetGPane.GetBoard.GetData(x, y + 1);}		iAm := CInfoApp(gApplication).GetGPane.GetBoard.GetData(x, y);		Push := FALSE;		if whatAt = 129 then			begin				pUsH := true;				whatAt := CInfoApp(gApplication).GetGPane.GetBoard.GetData(x, y);				CInfoApp(gapplication).GetGPane.GetBoard.SetData(whereTo.h, whereTo.v, whatAt);				CInfoApp(gapplication).GetGPane.GetBoard.boardData^^.theBoard[x, y] := 129; {MUST be done this way}				CInfoAPp(gapplication).GetGPane.GetBPane.Draw1(x, y);			{We can explain to you if you wish.}				CInfoApp(gapplication).GetGPane.GetBPane.Draw1(whereTo.h, whereTo.v);				self.CheckFall(whereTo.h, whereTo.v);			end;	end;	procedure CZonk.InitPiece;	begin		inherited InitPiece;		rounded := true;		destructable := true;	end;	procedure CZonk.Roll (x, y, dir: integer);		var			fallDir: integer;			myChore: CMoveChore;			whereTo: point;			what: integer;	begin		if dir = kLeft then			falldir := kDownLeft		else			fallDir := kDownRight;{    whereTo := CInfoApp(gapplication).LocFromDir(x, y, fallDir);}{    what := CInfoApp(gapplication).GetGPane.GetBoard.GetData(whereTo.h, whereTo.v);}{    if not CInfoApp(gapplication).HasSuicide[x, y] then}{    begin}		new(myChore);		myChore.IMoveChore(fallDir, falldir, boulder, x, y);		CInfoApp(gApplication).FudADD(myChore);{    end;}	end;	function CZonk.WalkOnto (x, y: integer): boolean;	begin		WalkOnto := false;		if (CInfoApp(gApplication).GetMurphy.GetLastDir = kRight) or (CInfoApp(CInfoApp(gApplication)).GetMurphy.GetLastDir = kLeft) then			WalkOnto := Push(x, y);	end;end.